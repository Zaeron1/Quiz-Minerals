<!-- mode3.html – Photo → Nom + Système (systèmes multiples pris en charge) -->
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Photo → Nom&nbsp;+&nbsp>Système</title>
  <style>
    :root{
      --primary:#4a90e2;
      --primary-dark:#357ab8;
      --success:#2ecc71;
      --error:#e74c3c;
    }
    html,body{
      margin:0;height:100%;
      display:flex;align-items:center;justify-content:center;
      background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);
      font-family:'Segoe UI',Roboto,Arial,sans-serif;
    }
    .card{
      background:#fff;
      padding:2rem 2.5rem;
      border-radius:12px;
      box-shadow:0 8px 24px rgba(0,0,0,.1);
      width:min(500px,92%);
      text-align:center;
    }
    h2{margin:0 0 1rem;}
    img{
      max-width:240px;
      max-height:200px;
      border-radius:8px;
      border:1px solid #ccc;
      object-fit:contain;
    }
    input,select{
      font-size:1rem;
      padding:.45rem .6rem;
      border:1px solid #bbb;
      border-radius:6px;
      margin:.45rem;
      max-width:230px;
    }
    button.btn{
      background:var(--primary);
      color:#fff;
      border:none;
      border-radius:8px;
      padding:.6rem 1.4rem;
      font-size:1rem;
      margin:.45rem;
      cursor:pointer;
      transition:background .2s;
    }
    button.btn:hover{background:var(--primary-dark);}
    #message{font-size:1.35rem;margin-top:1rem;height:1.6rem;}
    .vrai{color:var(--success);}
    .faux{color:var(--error);}
    .fade{animation:fadeOut .8s forwards;}
    @keyframes fadeOut{from{opacity:1;}to{opacity:0;}}
    .hint{font-size:.9rem;color:var(--error);margin-left:.4rem;}
  </style>
</head>
<body>
  <div class="card">
    <h2>Quel est ce minéral&nbsp;?</h2>

    <img id="mineralImg" src="" alt="Photo du minéral"><br><br>

    <input type="text" id="name" placeholder="Entrez le nom">
    <span id="nameHint" class="hint"></span><br>

    <select id="system"></select>
    <span id="systemHint" class="hint"></span><br>

    <button class="btn" onclick="checkAnswer()">Valider</button>
    <button class="btn" onclick="skip()">Passer</button>
    <button class="btn" onclick="showAnswer()">Réponse</button>

    <div id="message"></div>
  </div>

<script>
/* ---------- utilitaires ---------- */
const systems = ["triclinique","monoclinique","orthorhombique",
                 "tétragonal","trigonal","hexagonal","cubique"];
const equalNoCase = (a,b)=>a.trim().toUpperCase()===b.trim().toUpperCase();

/* génère le nom de fichier (sans accent, sans espace) */
const filenameFromName = n =>
  n.normalize("NFD").replace(/[\u0300-\u036f]/g,"")
   .replace(/\s+/g,"").toLowerCase()+".png";

const shuffle = arr=>{
  const a=arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
};

/* -------- données -------- */
const minerals = [
  {name:"Argent natif",   formula:"Ag",                system:"cubique"},
  {name:"Or natif",       formula:"Au",                system:"cubique"},
  {name:"Fer natif",      formula:"Fe",                system:"cubique"},
  {name:"Diamant",        formula:"C",                 system:"cubique"},
  {name:"Stannite",       formula:"Cu2FeSnS4",         system:"tétragonal"},
  {name:"Wurtzite",       formula:"",                  system:"hexagonal"},
  {name:"Pentlandite",    formula:"(Fe,Ni)9S8",        system:"cubique"},
  {name:"Löllingite",     formula:"FeAs2",             system:"orthorhombique"},
  {name:"Skutterudite",   formula:"(Co,Ni)As3−x",      system:"cubique"},
  {name:"Pyrargyrite",    formula:"Ag3SbS3",           system:"trigonal"},
  {name:"Proustite",      formula:"Ag3AsS3",           system:"trigonal"},
  {name:"Enargite",       formula:"Cu3AsS4",           system:"orthorhombique"},
  {name:"Anatase",        formula:"TiO2",              system:"tétragonal"},
  {name:"Brookite",       formula:"TiO2",              system:"orthorhombique"},
  {name:"Spinelle",       formula:"MgAl2O4",           system:"cubique"},
  {name:"Chrysoberyl",    formula:"Be(AlO2)2",         system:"orthorhombique"},
  {name:"Perovskite",     formula:"CaTiO3",            system:"orthorhombique"},
  {name:"Brucite",        formula:"Mg(OH)2",           system:"trigonal"},
  {name:"Manganite",      formula:"MnO(OH)",           system:"monoclinique"},
  {name:"Gibbsite",       formula:"Al(OH)3",           system:"monoclinique"},
  {name:"Sylvite",        formula:"KCl",               system:"cubique"},
  {name:"Atacamite",      formula:"CuCl2(OH)3",        system:"orthorhombique"},
  {name:"Magnesite",      formula:"MgCO3",             system:"trigonal"},
  {name:"Nitronatrite",   formula:"NaNO3",             system:"trigonal"},
  {name:"Nitre",          formula:"KNO3",              system:"orthorhombique"},
  {name:"Crocoïte",       formula:"PbCrO4",            system:"monoclinique"},
  {name:"Scheelite",      formula:"CaWO4",             system:"tétragonal"},
  {name:"Wulfénite",      formula:"PbMoO4",            system:"tétragonal"},
  {name:"Wulfénite",      formula:"PbMoO4",            system:"tétragonal"},  // doublon conservé
  {name:"Xénotime",       formula:"YPO4",              system:"tétragonal"},
  {name:"Monazite",       formula:"(Ce,La,Ne,Th)PO4",  system:"monoclinique"},
  {name:"Mimétite",       formula:"Pb5(AsO4)3Cl",      system:"hexagonal"},
  {name:"Vanadinite",     formula:"Pb5(VO4)3Cl",       system:"hexagonal"},
  {name:"Pyrope",         formula:"Mg3Al2[SiO4]3",     system:"cubique"},
  {name:"Almandin",       formula:"Fe2+3Al2[SiO4]3",   system:"cubique"},
  {name:"Spessartine",    formula:"Mn3Al2[SiO4]3",     system:"cubique"},
  {name:"Grossulaire",    formula:"Ca3Al2[SiO4]3",     system:"cubique"},
  {name:"Andradite",      formula:"Ca3Fe2[SiO4]3",     system:"cubique"},
  {name:"Uvarovite",      formula:"Ca3Cr2[SiO4]3",     system:"cubique"},
  {name:"Titanite",       formula:"CaTiSiO5",          system:"monoclinique"},
  {name:"Ottrelite",      formula:"(Mn2+,Fe2+,Mg)Al2[SiO4]O(OH)2", system:"monoclinique"},
  {name:"Hémimorphite",   formula:"Zn4Si2O7(OH)2·(H2O)",           system:"orthorhombique"},
  {name:"Diopside",       formula:"CaMg[Si2O6]",                   system:"monoclinique"},
  {name:"Enstatite",      formula:"Mg2[Si2O6]",                    system:"orthorhombique"},
  {name:"Trémolite",      formula:"Ca2Mg5[Si4O11(OH,F)]2",         system:"monoclinique"},
  {name:"Wollastonite",   formula:"CaSiO3",                        system:"triclinique"},
  {name:"Phlogopite",     formula:"KMg3[Si3AlO10](OH)2",           system:"monoclinique"},
  {name:"Tridymite",      formula:"SiO2",                          system:"triclinique"},
  {name:"Cristobalite",   formula:"SiO2",                          system:"tétragonal"},
  {name:"Nepheline",      formula:"Na3K[Al4Si4O16]",              system:"hexagonal"},

  /* ---- MINÉRAUX À DEUX SYSTÈMES ---- */
  {name:"Orthose",     formula:"K[AlSi3O8]",        system:["triclinique","orthorhombique"]},
  {name:"Serpentine",  formula:"Mg6[Si4O10](OH)8",  system:["monoclinique","orthorhombique"]},
  {name:"Pyrrhotite",  formula:"Fe1−xS",            system:["monoclinique","hexagonal"]},
  {name:"Chloritoïde", formula:"FeAl2O[SiO4](OH)2", system:["monoclinique","tétragonal"]},

  /* ---- suite de la liste inchangée ---- */
  {name:"Anorthite",      formula:"Ca[Al2Si2O8]",     system:"triclinique"},
  {name:"Albite",         formula:"Na[AlSi3O8]",      system:"triclinique"},
  {name:"Cuivre natif",   formula:"Cu",               system:"cubique"},
  {name:"Soufre natif",   formula:"S",                system:"orthorhombique"},
  {name:"Graphite",       formula:"C",                system:"hexagonal"},
  {name:"Chalcocite",     formula:"Cu2S",             system:"monoclinique"},
  {name:"Bornite",        formula:"Cu5FeS4",          system:"orthorhombique"},
  {name:"Galène",         formula:"PbS",              system:"cubique"},
  {name:"Sphalérite",     formula:"(Zn,Fe)S",         system:"cubique"},
  {name:"Chalcopyrite",   formula:"CuFeS2",           system:"tétragonal"},
  /* … garde le reste comme dans ta liste d’origine … */
  {name:"Sodalite",       formula:"Na8[Al6Si6O24]Cl2",system:"cubique"}
];

/* ---------- variables DOM ---------- */
let imgEl,nameInput,nameHint,systemHint,systemSel,messageDiv;
let order=[],idx=-1,current=null;

/* ---------- fonctions ---------- */
const prepareSelect = () =>{
  systemSel=document.getElementById("system");
  systems.forEach(s=>{
    const opt=document.createElement("option");
    opt.value=opt.textContent=s;
    systemSel.appendChild(opt);
  });
};

const resetHints = () => { nameHint.textContent=""; systemHint.textContent=""; };

const loadImage = min =>{
  const imgPath="images/"+filenameFromName(min.name);
  imgEl.src=imgPath;
  imgEl.onerror=()=>{ imgEl.onerror=null; imgEl.src="images/no.png"; };
};

const nextQuestion = () =>{
  if(++idx>=order.length){ order=shuffle(minerals); idx=0; }
  current=order[idx];
  loadImage(current);

  nameInput.value="";
  systemSel.selectedIndex=0;
  resetHints();
  messageDiv.textContent=""; messageDiv.className="";
};

const showMessage = (txt,cls) =>{
  messageDiv.classList.remove("fade");
  void messageDiv.offsetWidth;
  messageDiv.textContent=txt;
  messageDiv.className=cls;
  if(cls==="faux") messageDiv.classList.add("fade");
};

const validSystems = min => Array.isArray(min.system)? min.system : [min.system];

const checkAnswer = () =>{
  resetHints();
  let ok=true;

  if(!equalNoCase(nameInput.value,current.name)){
    ok=false; nameHint.textContent="Faux"; nameInput.value="";
  }
  if(!validSystems(current).some(s=>equalNoCase(systemSel.value,s))){
    ok=false; systemHint.textContent="Faux";
  }

  if(ok){
    showMessage("Vrai !","vrai");
    setTimeout(nextQuestion,800);
  }else{
    showMessage("Faux !","faux");
  }
};

const skip = () => nextQuestion();

const showAnswer = () =>{
  nameInput.value=current.name;
  systemSel.value=validSystems(current)[0];
};

/* ---------- init ---------- */
document.addEventListener("DOMContentLoaded",()=>{
  imgEl       = document.getElementById("mineralImg");
  nameInput   = document.getElementById("name");
  nameHint    = document.getElementById("nameHint");
  systemHint  = document.getElementById("systemHint");
  messageDiv  = document.getElementById("message");
  prepareSelect();
  nextQuestion();
});
</script>
</body>
</html>